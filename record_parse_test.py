import unittest
import os
import json
from decimal import Decimal

from scraping import handle_record


class MyTestCase(unittest.TestCase):
    def test_record_parsing(self):
        """
        Test for first record of point query output. Uses hardcode transformation to a list

        https://services.arcgis.com/cJ9YHowT8TU7DUyn/ArcGIS/rest/services/
        US_Underground_Storage_Tank_2019/FeatureServer/1
        """
        with open(f"{os.getcwd()}\\test_files\\test_query_output.json") as f:
            query_response = json.load(f, parse_float=Decimal)
        features = query_response["features"]
        record = handle_record(query_response["geometryType"], features[0])
        expected_record = [
            "1", "", "AK2472", "Amchitka ROTHR Facility", "Amchitka", "", "", "", "Alaska",
            "51.5405999999999", "-178.985809999999", "State", "", "", "Open", "", "", "0", "", "No",
            "", "", "", "", "No", "", "", "", "", "", "1", "", "-178.98579462636121",
            "51.540601367881848"
        ]
        self.assertEqual(record, expected_record)

    def test_record_parsing2(self):
        """
        Test for second record of point query output. Uses hardcode transformation to a list

        https://services.arcgis.com/cJ9YHowT8TU7DUyn/ArcGIS/rest/services/
        US_Underground_Storage_Tank_2019/FeatureServer/1
        """
        with open(f"{os.getcwd()}\\test_files\\test_query_output.json") as f:
            query_response = json.load(f, parse_float=Decimal)
        features = query_response["features"]
        record = handle_record(query_response["geometryType"], features[1])
        expected_record = [
            "2", "", "AK1", "Adak Old Fuel Truck Shop UST T10520A",
            "Adak Naval Air Facility; Old Fuel Truck Shop", "Adak", "", "", "Alaska", "51.86417",
            "-176.645999999999", "State", "", "", "No Further Action", "", "0", "0", "", "No",
            "", "", "", "", "No", "", "", "", "", "", "", "1", "-176.64598410887371",
            "51.864171156726883"
        ]
        self.assertEqual(record, expected_record)

    def test_record_parsing_multipoint(self):
        """
        Test for record of multipoint query output. Uses hardcode transformation to a list

        https://gisp.mcgi.state.mi.us/arcgis/rest/services/DEQ/Environmental_Mgt/MapServer/3
        """
        with open(f"{os.getcwd()}\\test_files\\test_query_output_multipoint.json") as f:
            query_response = json.load(f, parse_float=Decimal)
        features = query_response["features"]
        record = handle_record(query_response["geometryType"], features[0])
        expected_record = [
            "00000001", "84765", "Transportation Garage", "720 E Main Ave", "Zeeland", "Ottawa",
            "Grand Rapids", "49464", "42.811827", "-86.001792", "NAD83", "100", "FEET",
            "2004-03-25 00:00:00", "State of MI", "POINT", "Plant Entrance (Freight)",
            "GPS Code Meas. Standard Positioning Service SA Off", "YES", "2021-02-01 21:00:11.503",
            "", "", "0", "1", "1", "0", "1",
            "[[-86.001786641331179, 42.811818896892859]]"
        ]
        self.assertEqual(record, expected_record)

    def test_record_parsing_polygon(self):
        """
        Test for record of polygon query output. Uses hardcode transformation to a list

        https://gis7.nsgc.gov.ns.ca/arcgis/rest/services/ISD_GIS/Property/MapServer/0
        """
        with open(f"{os.getcwd()}\\test_files\\test_query_output_polygon.json") as f:
            query_response = json.load(f, parse_float=Decimal)
        features = query_response["features"]
        record = handle_record(query_response["geometryType"], features[0])
        self.maxDiff = None
        expected_record = [
            "157496736", "13531.423119999999", "CDPIAR8", "40901803", "1001", "ROAD_SEG",
            "00000003", "mu9938", "20210527", "298174.87290000002", "13531.423115329901",
            "[[[-63.900165951774348, 44.710449468181046], [-63.9001980125744, "
            "44.710449125435105], [-63.900214040881117, 44.710448819039648], "
            "[-63.900230071978498, 44.710448692667448], [-63.900294185202718, "
            "44.710447467054173], [-63.900310212112693, 44.71044707063249], [-63.900326115584498, "
            "44.710446855229215], [-63.900342142494011, 44.71044645880302], [-63.900358168007671, "
            "44.710445972361896], [-63.90037419631232, 44.710445665943979], [-63.900390221825418, "
            "44.710445179498336], [-63.900406248733916, 44.710444783063203], "
            "[-63.900413567230167, 44.71044454531237], [-63.90044561965037, 44.710443662420552], "
            "[-63.900461769995452, 44.71044308495685], [-63.900477669277819, 44.710442599494279], "
            "[-63.900493694788963, 44.710442113034127], [-63.900541767132879, "
            "44.710440383602027], [-63.900557789850851, 44.710439717107427], "
            "[-63.900573689131271, 44.71043923163149], [-63.900589710452529, 44.710438475119687], "
            "[-63.900621757281783, 44.710437232127525], [-63.900637652372659, "
            "44.710436476604514], [-63.900653927546415, 44.710435808105395], "
            "[-63.900669824032526, 44.710435142590647], [-63.900685717725999, "
            "44.710434297048238], [-63.900717761758081, 44.710432874003729], "
            "[-63.900733655450125, 44.710432028454612], [-63.90076569668706, 44.710430425371229], "
            "[-63.900781590377619, 44.710429579815468], [-63.900797735129466, "
            "44.710428642253397], [-63.900813628819009, 44.710427796693196], [-63.90082964873708, "
            "44.710426950135052], [-63.900845667258288, 44.710426013561936], "
            "[-63.900861559549888, 44.71042507798235], [-63.900877578069988, 44.710424141404772], "
            "[-63.900893595193075, 44.71042311481223], [-63.900909613712045, 44.710422178230139], "
            "[-63.900941395497206, 44.710420127025543], [-63.900957414014478, "
            "44.710419190436809], [-63.900973303509019, 44.710418074816246], "
            "[-63.900989417528891, 44.710415156947235], [-63.901005336350821, "
            "44.710415931589417], [-63.901021225843422, 44.710414815962167], "
            "[-63.901037241564396, 44.710413699336819], [-63.901053131055761, "
            "44.710412583705171], [-63.90106914677542, 44.710411467075318], [-63.9010850348687, "
            "44.710410261426539], [-63.901101050587073, 44.710409144792223], "
            "[-63.901116937282183, 44.710407849126291], [-63.901132825373374, "
            "44.710406643470868], [-63.901164726385794, 44.710404141144579], "
            "[-63.901180739306959, 44.710402844473698], [-63.901212514086033, "
            "44.710400343130203], [-63.901292195795186, 44.710393592670485], "
            "[-63.901339848865753, 44.710389255522941], [-63.901387500531683, "
            "44.710384828342789], [-63.901403510647576, 44.710383351615306], "
            "[-63.901419393136422, 44.710381785869274], [-63.90143515079275, 44.710380311130116], "
            "[-63.901451031882523, 44.710378655366995], [-63.901467040597623, "
            "44.710377088617911], [-63.901482796853983, 44.710375523859518], "
            "[-63.901514559027049, 44.710372212317814], [-63.901546322593823, "
            "44.710368990779997], [-63.901562076050716, 44.710367245985275], "
            "[-63.901578084759429, 44.710365679220686], [-63.901593836816858, "
            "44.710363844408853], [-63.901609590270816, 44.710362099607607], [-63.90162559618156, "
            "44.710360352810952], [-63.901657101686929, 44.710356773184841], "
            "[-63.901673106197009, 44.71035493636883], [-63.901720489974437, 44.710349520903733], "
            "[-63.901736368251527, 44.710347685075604], [-63.901783747823245, 44.71034199954623], "
            "[-63.901799497071607, 44.710339984680758], [-63.901815373945546, "
            "44.710338058828981], [-63.901831222860302, 44.710334332720976], "
            "[-63.901847000063398, 44.710334118103006], [-63.901862749307284, "
            "44.710332103228836], [-63.901878370923299, 44.710329999336679], "
            "[-63.901894247791709, 44.710328073473988], [-63.901925869704293, "
            "44.710323862688149], [-63.901941492713732, 44.710321848800078], "
            "[-63.901957239154619, 44.710319653887524], [-63.901973113221189, "
            "44.710317547988531], [-63.901988734829033, 44.710315444081324], "
            "[-63.902020227702351, 44.710311054241046], [-63.902036003499795, "
            "44.710310749584345], [-63.902051721969002, 44.710306754404854], "
            "[-63.902083212036004, 44.7103021845219], [-63.902098958465913, 44.710299989589899], "
            "[-63.902114577267525, 44.71029770564018], [-63.902130320898245, 44.710295330678427], "
            "[-63.902145941095689, 44.710293136737107], [-63.902177428350619, "
            "44.710288386802908], [-63.902208790770061, 44.710283727869985], [-63.90222465922308, "
            "44.710281261885378], [-63.902240150387243, 44.710278888903119], [-63.90225576777879, "
            "44.710276514921446], [-63.902271383770454, 44.710274050924987], "
            "[-63.902302712607053, 44.710267231661767], [-63.902318356567214, "
            "44.710266567912747], [-63.902334097383367, 44.710264012897667], "
            "[-63.902349585740829, 44.710261459875269], [-63.902365327952879, "
            "44.710258994868596], [-63.902380816307556, 44.710256441841942], "
            "[-63.902396555719299, 44.710253796805603], [-63.902412045469973, "
            "44.710251333787419], [-63.902427784878846, 44.710248688746844], "
            "[-63.902443271829057, 44.710246045699073], [-63.902459009836143, "
            "44.710243310641481], [-63.902474498182322, 44.710240757602193], "
            "[-63.902505595503335, 44.710235290469029], [-63.902521334903398, "
            "44.710232645415559], [-63.90253682044591, 44.710229912342491], [-63.902552430816435, "
            "44.710227088257035], [-63.90256791635592, 44.710224355179747], [-63.902614622624291, "
            "44.71021597391465], [-63.902629854301573, 44.71021315281174], [-63.90264559089141, "
            "44.71021032771587], [-63.902676682582481, 44.710204500485609], [-63.902692166710622, "
            "44.71020167737889], [-63.902723132163722, 44.71019585113384], [-63.902738613488587, "
            "44.710192847995501], [-63.902754096211147, 44.71018993486777], [-63.902769703761237, "
            "44.710186930727374], [-63.902800540171128, 44.710180925433939], "
            "[-63.902816021487858, 44.710177922285162], [-63.902846855089074, "
            "44.710171736953924], [-63.902862307011489, 44.710166843532633], "
            "[-63.902877816311502, 44.7101656406291], [-63.902893168592534, 44.710162458442547], "
            "[-63.902924128405381, 44.710156272092561], [-63.902954832955508, "
            "44.710149907705009], [-63.902970183828344, 44.710146635495498], "
            "[-63.902985663727151, 44.710143542311151], [-63.903062418056308, "
            "44.710127181222404], [-63.903092990747652, 44.71012045774544], [-63.903108467832944, "
            "44.710117184519198], [-63.903139040513516, 44.710110461029977], "
            "[-63.903200307881278, 44.710096742990721], [-63.903215529697434, "
            "44.710093291721421], [-63.903230750111689, 44.71008975043739], [-63.903246099552447, "
            "44.710086388178347], [-63.903291760778366, 44.710075764308144], "
            "[-63.903307107411429, 44.710072222015597], [-63.903322201586228, "
            "44.710068681717921], [-63.903337420587107, 44.710065050407117], "
            "[-63.903352765814205, 44.71006141809579], [-63.903367986211471, 44.71005787679362], "
            "[-63.903383077578127, 44.71005415646264], [-63.903398296571275, 44.710050525143778], "
            "[-63.903443824510219, 44.710039452148372], [-63.903482944208577, "
            "44.710030320332464], [-63.905158944118199, 44.709519397070018], "
            "[-63.905932283073462, 44.709291356272722], [-63.906119144640641, 44.70923621959701], "
            "[-63.908552081829569, 44.708292345266116], [-63.90894205058472, 44.708139982635686], "
            "[-63.90964453531992, 44.707815164872699], [-63.91051323058926, 44.707334986989288], "
            "[-63.911280879200582, 44.706924477036701], [-63.911959410297449, "
            "44.706531057930782], [-63.913495335644313, 44.705600809380122], "
            "[-63.914079175292571, 44.705256387774313], [-63.914500517887291, "
            "44.705030385544404], [-63.918870380801991, 44.702337444289405], "
            "[-63.920403508626464, 44.701403883835134], [-63.921519483028455, "
            "44.700736809434147], [-63.922941768500131, 44.699886750978642], "
            "[-63.923696295520209, 44.699440613647994], [-63.92374600503932, 44.699415454987715], "
            "[-63.924794545841316, 44.69888591020608], [-63.925922126655003, 44.698501823740962], "
            "[-63.927391023267305, 44.698088487814445], [-63.928345439575267, "
            "44.697880519929122], [-63.930626169798082, 44.697383209322957], "
            "[-63.931328129255604, 44.69723020760113], [-63.932776766566121, 44.696919414775266], "
            "[-63.93334869991623, 44.696796990457656], [-63.934798076955879, 44.696478603910421], "
            "[-63.935077498770482, 44.696901049254244], [-63.932325972765753, "
            "44.697496458426777], [-63.929078566219964, 44.698262921025915], "
            "[-63.926105756860998, 44.698991595213478], [-63.923403799227579, "
            "44.700112846959158], [-63.921083395144862, 44.701509851700244], [-63.91207638015041, "
            "44.706961877897392], [-63.909977089719128, 44.708164238330475], "
            "[-63.907329980240128, 44.709207070540451], [-63.906918455208562, "
            "44.709337903107333], [-63.905511636459238, 44.709784691753875], "
            "[-63.904705231552434, 44.710013891881928], [-63.903896179211834, "
            "44.710243737427795], [-63.903870161988692, 44.7102511452537], [-63.902536745747057, "
            "44.710631238765792], [-63.900227902841515, 44.710813665998899], "
            "[-63.898087469429932, 44.710645880277568], [-63.897133868537708, "
            "44.710445060715699], [-63.896641077187347, 44.710285897971843], "
            "[-63.895381561916473, 44.709927132965745], [-63.89412274968727, 44.709490027868533], "
            "[-63.892757917002136, 44.70870003434851], [-63.891298391119541, 44.707931378945517], "
            "[-63.889315826460745, 44.706959904414781], [-63.887511246137365, "
            "44.706206670298656], [-63.884500753485355, 44.705251288049446], "
            "[-63.881377909272693, 44.704447033235631], [-63.881357126411771, "
            "44.704441702179516], [-63.880776084524904, 44.704291974177202], "
            "[-63.875573726941823, 44.702894028478539], [-63.872734447928117, "
            "44.702303959878293], [-63.872726850843527, 44.702302397506678], "
            "[-63.872285825765616, 44.702210701811438], [-63.869214807633689, "
            "44.701802453250437], [-63.864987129030659, 44.701700777897692], "
            "[-63.861693833937451, 44.701525821908731], [-63.859132452551215, "
            "44.701319610226903], [-63.860257264561334, 44.700332492829631], "
            "[-63.862445312224068, 44.701028258607259], [-63.862460757946948, "
            "44.701031382819203], [-63.862476205007923, 44.701034597042849], "
            "[-63.862491523187643, 44.701037632189973], [-63.862507093788828, "
            "44.701040665428621], [-63.862522536845141, 44.701043609604554], "
            "[-63.862537982576086, 44.701046733805995], [-63.862553550508878, "
            "44.701049587010637], [-63.862568993569809, 44.701052531180252], "
            "[-63.862584435295638, 44.701055385333973], [-63.862600004569586, "
            "44.701058328546047], [-63.862615571171723, 44.701061091728391], [-63.86263113777531, "
            "44.701063854908575], [-63.862646704380332, 44.701066618086664], "
            "[-63.862662269650059, 44.701069291248821], [-63.862677834921172, 44.70107196440884], "
            "[-63.862693398856898, 44.701074547552913], [-63.862709090340815, "
            "44.701077219755227], [-63.862724654279276, 44.701079802895045], "
            "[-63.862740343092213, 44.701082295065412], [-63.862755905696439, "
            "44.701084788187146], [-63.862771594512012, 44.701087280353214], "
            "[-63.862787157118881, 44.701089773470642], [-63.862802969473158, "
            "44.701092084651272], [-63.862818532082585, 44.701094577764401], "
            "[-63.862834343102342, 44.701096798926876], [-63.862850029250268, "
            "44.701099111054525], [-63.862865587852241, 44.701101334119855], "
            "[-63.862881400212657, 44.701103645289557], [-63.862897209900005, "
            "44.701105776429486], [-63.862912893378443, 44.701107908520896], "
            "[-63.862928703068071, 44.701110039656434], [-63.862944386548719, "
            "44.701112171743482], [-63.86296019490338, 44.701114212860865], [-63.862975875711768, "
            "44.701116164916016], [-63.862991684068554, 44.701118206029037], "
            "[-63.863007491089107, 44.701120157126013], [-63.863023296773378, "
            "44.701122018207037], [-63.863039103795955, 44.70112396929968], [-63.863054909482202, "
            "44.701125830376306], [-63.863070840042163, 44.701127600483119], "
            "[-63.863086518182797, 44.701129372495416], [-63.863102448744613, "
            "44.701131142597802], [-63.863118251759765, 44.701132823638083], "
            "[-63.863134180985938, 44.701134503722244], [-63.86314998400286, 44.701136184758084], "
            "[-63.863165785683115, 44.701137775777973], [-63.863181712236795, "
            "44.701139275827913], [-63.863197640128845, 44.701140865889414], "
            "[-63.863213440473963, 44.701142366888867], [-63.863229365692384, "
            "44.701143776918364], [-63.863245418459336, 44.701145276005363], "
            "[-63.863261216131413, 44.701146596970659], [-63.863277140014333, "
            "44.701147916979686], [-63.863293065235673, 44.701149327000259], "
            "[-63.863308989119986, 44.701150647004823], [-63.863324910329418, "
            "44.701151786979608], [-63.863340834215066, 44.701153106979731], "
            "[-63.863356881635887, 44.701154245995895], [-63.863372676636949, 44.70115538691816], "
            "[-63.863388724058971, 44.701156525929846], [-63.863404643933492, "
            "44.701157575879691], [-63.863420690018714, 44.701158624873138], [-63.86343648234616, "
            "44.701159585758973], [-63.863452528432475, 44.701160634747907], "
            "[-63.863468571843271, 44.701161503707006], [-63.863484615254521, "
            "44.701162372663866], [-63.863500407583913, 44.701163333540883], [-63.863516449658, "
            "44.701164112479482], [-63.863532491732471, 44.7011648914158], [-63.863548533807332, "
            "44.701165670349866], [-63.863564448334252, 44.701166360222302], "
            "[-63.863580362861512, 44.701167050092529], [-63.863592614617204, "
            "44.701167587611124], [-63.863589227596307, 44.701211454860534], "
            "[-63.864366352534027, 44.701242755390624], [-63.867090051813527, "
            "44.701345980367449], [-63.868994328978253, 44.701416848423726], "
            "[-63.869263472635843, 44.701435865665694], [-63.870347910410842, "
            "44.701514299006526], [-63.870405301792687, 44.701519983220145], [-63.87096051810677, "
            "44.701575706035939], [-63.871483578666719, 44.701633472021555], "
            "[-63.872046605092358, 44.701721628575662], [-63.872317590007142, 44.7017622302889], "
            "[-63.872512423043041, 44.701791890146239], [-63.872526973842625, "
            "44.701794209618434], [-63.872542537037582, 44.701796701401356], "
            "[-63.872558101585994, 44.701799283195669], [-63.872573792347026, "
            "44.701801864023516], [-63.872589356898139, 44.701804445813558], [-63.87260504630968, "
            "44.70180693662352], [-63.87266743209662, 44.701817352802834], [-63.87268299800818, "
            "44.701820024593601], [-63.872729817905395, 44.701827768947886], "
            "[-63.872745511386256, 44.701830529779102], [-63.872760949741014, "
            "44.701833112510137], [-63.87279220779358, 44.701838455099299], [-63.872823339640405, "
            "44.701843798644461], [-63.87285456929979, 44.701847250932026], [-63.872870038773783, "
            "44.701851903959749], [-63.872885606056172, 44.701854665736249], [-63.87290117198733, "
            "44.701857337497081], [-63.872916739272597, 44.701860099269339], "
            "[-63.872932432770696, 44.701862860074698], [-63.872947872494727, "
            "44.701865532793882], [-63.872963439784307, 44.701868294559738], "
            "[-63.872994449509235, 44.70187390906338], [-63.873010143014611, 44.701876669857995], "
            "[-63.873025584098585, 44.701879432580164], [-63.873041152748335, "
            "44.701882284348876], [-63.873072161134999, 44.701887808817752], "
            "[-63.873087856000609, 44.701890659615145], [-63.873118740890554, 44.70189636506327], "
            "[-63.87313443440766, 44.701899125840711], [-63.873196331775894, 44.701910625751708], "
            "[-63.873211998237409, 44.701911586247753], [-63.873258482944394, "
            "44.701922213712265], [-63.873273925405051, 44.701925066414177], "
            "[-63.873289370573751, 44.701928099141021], [-63.873304939248975, "
            "44.701930950873546], [-63.873397855959531, 44.701948695179674], "
            "[-63.873413174929176, 44.70195172885493], [-63.873428746323555, 44.701954760597523], "
            "[-63.873444190154409, 44.701957703289764], [-63.873459635340325, "
            "44.701960735993467], [-63.873475206739435, 44.701963767729666], "
            "[-63.873490525716939, 44.701966801394505], [-63.873521542311494, "
            "44.701972865821702], [-63.873536862647398, 44.70197598949381], [-63.87356787925151, "
            "44.701982053908367], [-63.873583198238506, 44.701985087560672], "
            "[-63.873614091348045, 44.701991332955117], [-63.873629536551476, "
            "44.701994365635635], [-63.873644856898643, 44.701997489293142], "
            "[-63.873660429670764, 44.702000611017489], [-63.873675750021178, "
            "44.702003734670775], [-63.873691196584879, 44.702006857356466], "
            "[-63.873721964859456, 44.702013193700608], [-63.873752857998348, "
            "44.702019439057217], [-63.873768179712535, 44.702022652711591], "
            "[-63.873783627640108, 44.702025865398184], [-63.873799074215306, "
            "44.702028988069138], [-63.87382971765534, 44.702035415363284], [-63.873845164235455, "
            "44.702038538027992], [-63.87386061352553, 44.702041840717591], [-63.873922028004998, "
            "44.702054784312004], [-63.87393735109184, 44.702058087956985], [-63.873968120773803, "
            "44.702064514247851], [-63.873998894525577, 44.702071210570921], "
            "[-63.874014216266566, 44.702074424192013], [-63.874029413151838, "
            "44.702077728790535], [-63.874090833123674, 44.702091032347525], "
            "[-63.874106156229367, 44.702094335969718], [-63.874121482045894, "
            "44.702097819616839], [-63.874136805155054, 44.702101123234861], "
            "[-63.874152003408668, 44.702104517830428], [-63.874167452733161, "
            "44.702107820478226], [-63.874182777202144, 44.702111214103539], [-63.87419797681568, "
            "44.702114698706453], [-63.874213301288222, 44.702118092327666], "
            "[-63.874228624407763, 44.702121395933297], [-63.874243950238565, "
            "44.702124879563861], [-63.874259149859228, 44.702128364158575], "
            "[-63.874274600550756, 44.702131756805279], [-63.874304997091365, "
            "44.702138545957396], [-63.874320322931112, 44.702142029577637], "
            "[-63.874335650127577, 44.702145603209317], [-63.874350848404092, "
            "44.702148997778202], [-63.874366174249268, 44.70215248139224], [-63.874411900726678, "
            "44.702163024168144], [-63.874427226579094, 44.70216650777391], [-63.874472953078303, "
            "44.702177050525187], [-63.874488154081085, 44.70218062510267], [-63.874503353730553, "
            "44.702184109664621], [-63.874518554737001, 44.702187684238019], "
            "[-63.874523874615377, 44.702188903833502], [-63.874554402847146, "
            "44.702196052006215], [-63.874569479002957, 44.702199717552809], "
            "[-63.874630409284038, 44.702214014832023], [-63.874645613016668, 44.70221776941537], "
            "[-63.874660687828296, 44.702221344936326], [-63.874675763997203, "
            "44.702225010468787], [-63.874691217448898, 44.702228583085649], "
            "[-63.874706293621557, 44.702232248614038], [-63.874721497363716, "
            "44.702236003187174], [-63.874736573540147, 44.702239668711549], "
            "[-63.874767104535131, 44.702246996853901], [-63.874782180717219, 44.70225066237218], "
            "[-63.87479738446897, 44.702254416935112], [-63.874812460654852, 44.702258082449383], "
            "[-63.874827664410454, 44.702261837008272], [-63.874842866812287, "
            "44.702265501551622], [-63.874873021908705, 44.702273012592997], "
            "[-63.874888225672002, 44.702276767143758], [-63.874933584549105, "
            "44.702288032717668], [-63.874948789676026, 44.702291877273794], "
            "[-63.874979071011701, 44.702299387319933], [-63.874994149932249, "
            "44.702303232836933], [-63.875009227498808, 44.702306988338464], "
            "[-63.875024307779221, 44.702310923864964], [-63.875039385349666, "
            "44.702314679362495], [-63.875099828643464, 44.702330150432715], "
            "[-63.875114781367429, 44.702333996900805], [-63.875145065458291, "
            "44.702341686929493], [-63.875160145756681, 44.702345622437853], "
            "[-63.875175224700897, 44.702349467930752], [-63.875190178790923, "
            "44.702353404402395], [-63.875220339401771, 44.702361275405138], "
            "[-63.875235418353924, 44.702365120890022], [-63.87525049866435, 44.702369056386352], "
            "[-63.875265454120765, 44.702373082861499], [-63.875280534435255, "
            "44.702377018353829], [-63.875295488539336, 44.702380954811545], "
            "[-63.875310568857842, 44.702384890299861], [-63.875325524322399, "
            "44.702388916767042], [-63.875340604644947, 44.7023928522514], [-63.875355686326039, "
            "44.702396877747184], [-63.875385597269421, 44.702404930667704], "
            "[-63.875400677600112, 44.702408866144012], [-63.875430588555759, "
            "44.702416919052617], [-63.876616130260189, 44.702735871746249], "
            "[-63.877511763702032, 44.702972957855984], [-63.878337191807788, 44.70319140183669], "
            "[-63.878888874876971, 44.703337407183717], [-63.8793101488736, 44.703448944658462], "
            "[-63.880080332797689, 44.703652767389208], [-63.880518086158268, "
            "44.703768584569097], [-63.880876970083364, 44.703869254281834], "
            "[-63.881748458274529, 44.704101722084815], [-63.882532245037382, "
            "44.704310734627079], [-63.883005004014564, 44.704436804517798], "
            "[-63.883477766387067, 44.704562962445543], [-63.883950529417234, "
            "44.704689028383804], [-63.884373736506696, 44.704801882541361], "
            "[-63.884378298150239, 44.704803017525101], [-63.884393381067532, "
            "44.704807041815712], [-63.88442329584413, 44.70481518235902], [-63.884423422061559, "
            "44.70481518138152], [-63.884438504985063, 44.704819205666084], [-63.884468418403372, "
            "44.704827256184295], [-63.88448350270378, 44.704831370476022], [-63.884513417505246, "
            "44.704839510995541], [-63.884528375594471, 44.704843626258949], "
            "[-63.884543332314983, 44.70484765150713], [-63.8845582904084, 44.704851766766545], "
            "[-63.884573247133005, 44.704855792010804], [-63.884588332819, 44.704859996301799], "
            "[-63.884603164701169, 44.704864112532952], [-63.884648039012816, "
            "44.704876458281575], [-63.884662870903341, 44.704880574504905], "
            "[-63.884692789867877, 44.704888985016574], [-63.884707621764697, "
            "44.704893101234042], [-63.884722707469876, 44.704897305507124], "
            "[-63.884737539370875, 44.704901421720635], [-63.884752489264528, "
            "44.704904996875115], [-63.884767333510332, 44.704909923203637], "
            "[-63.884782293006459, 44.704914128446632], [-63.884797126287133, "
            "44.704918334665543], [-63.884812085787551, 44.704922539904601], "
            "[-63.884856713237681, 44.704935247579073], [-63.884871674118038, "
            "44.704939542823411], [-63.884886507411508, 44.704943749030626], "
            "[-63.884901342078514, 44.704948045249076], [-63.884916175376247, "
            "44.704952251452383], [-63.88493113626528, 44.704956546688891], [-63.88494596133846, "
            "44.704960212809063], [-63.884960806985958, 44.704965229125321], "
            "[-63.885005311026063, 44.704978117745576], [-63.885020019492664, 44.70498241492659], "
            "[-63.885034980396959, 44.704986710149349], [-63.88504981782895, 44.704991186374713], "
            "[-63.88506465251988, 44.704995482571718], [-63.885079488584665, 44.704999868779986], "
            "[-63.885094323279972, 44.705004164973097], [-63.885109033131336, "
            "44.705008552155732], [-63.885138705276354, 44.705017324558661], "
            "[-63.885153416506142, 44.705021801748686], [-63.885168252584194, "
            "44.705026187945293], [-63.885182962446613, 44.705030575118265], "
            "[-63.885197798529092, 44.705034961311014], [-63.885212508395924, "
            "44.705039348480163], [-63.885227345854737, 44.7050438246822], [-63.885242055725989, "
            "44.70504821184749], [-63.885256894561273, 44.705052778058842], [-63.885271730654878, "
            "44.705057164241843], [-63.885301153156966, 44.705066118585357], "
            "[-63.885315990629309, 44.705070594775762], [-63.885360125778142, "
            "44.705084116284027], [-63.885366974479489, 44.705086223759281], "
            "[-63.885381811961935, 44.705090699941017], [-63.885396398382838, "
            "44.705095268091142], [-63.88541123586981, 44.70509974426902], [-63.885425948513259, "
            "44.705104311436749], [-63.885440659786774, 44.705108788589378], "
            "[-63.885455246216765, 44.705113356731907], [-63.885514096831663, "
            "44.705131625368359], [-63.885528684645436, 44.705136283514598], "
            "[-63.885558109971214, 44.705145417817477], [-63.885572696419459, 44.70514998594485], "
            "[-63.885587410460566, 44.705154643104727], [-63.885601998285864, "
            "44.705159301241473], [-63.885616712331633, 44.705163958397506], "
            "[-63.885631300161585, 44.705168616530464], [-63.885646012839445, "
            "44.705173183669508], [-63.885675188510895, 44.705182499925982], "
            "[-63.885689902568274, 44.705187157072494], [-63.885719079626355, 44.70519656333078], "
            "[-63.885733668845234, 44.705201311463696], [-63.885748382912006, "
            "44.705205968602584], [-63.885762972135616, 44.705210716731692], "
            "[-63.885777559988803, 44.705215374845757], [-63.885792149217117, "
            "44.705220122971092], [-63.885806737074972, 44.705224781081384], "
            "[-63.885850506153993, 44.705239115453629], [-63.885864969175827, "
            "44.705243864548635], [-63.885908736910331, 44.705258108885111], "
            "[-63.885923327532893, 44.705262947006652], [-63.885937790566508, "
            "44.705267696092342], [-63.885952381193846, 44.705272534210138], "
            "[-63.885966844232186, 44.705277283292091], [-63.885996026871972, "
            "44.705287049531435], [-63.886010491290556, 44.70529188862097], [-63.886025081929922, "
            "44.705296726729379], [-63.886054010779041, 44.705306404899119], [-63.88606860142562, "
            "44.705311243001866], [-63.886097530289092, 44.705320921160443], "
            "[-63.886111996097689, 44.705325850250112], [-63.88612658812724, 44.705330778358537], "
            "[-63.886155519756635, 44.705340636528554], [-63.886169984201615, "
            "44.705345475597632], [-63.886184197585351, 44.705350406636938], "
            "[-63.886198789627045, 44.705355334735984], [-63.886256652944162, "
            "44.705375051031581], [-63.886270993934495, 44.70538007109355], [-63.886299928359733, "
            "44.705390109252853], [-63.886314394202437, 44.705395038316567], "
            "[-63.886328735202611, 44.705400058371168], [-63.886343202423873, 44.70540507744434], "
            "[-63.886357542055272, 44.705410007482129], [-63.88637200928148, 44.705415026551627], "
            "[-63.88638635029146, 44.705420046598903], [-63.886400817522599, 44.705425065664649], "
            "[-63.886415159911294, 44.705430175721432], [-63.886443969541091, "
            "44.705440304836621], [-63.88645818434474, 44.705445325854512], [-63.886472652962112, "
            "44.705450434924238], [-63.886486993989422, 44.705455454958702], "
            "[-63.886530021207925, 44.705470785090654], [-63.886544362245111, "
            "44.705475805117857], [-63.886573047074897, 44.705486025193046], "
            "[-63.886587390867597, 44.705491225241055], [-63.886630418138644, "
            "44.705506555334637], [-63.886644520496851, 44.705512477440521], "
            "[-63.886658853309129, 44.705516957374208], [-63.886687540927468, "
            "44.705527357446542], [-63.886701757147328, 44.705532468446862], [-63.88671610096285, "
            "44.705537668478456], [-63.886730318561995, 44.705542869488298], "
            "[-63.886744662382583, 44.705548069516283], [-63.886758879986786, "
            "44.705553270522522], [-63.886773223812462, 44.705558470546876], [-63.88678731657712, "
            "44.705563762542788], [-63.886801534188919, 44.705568963543655], "
            "[-63.886815878022226, 44.705574163562581], [-63.886858535003824, "
            "44.705590036588376], [-63.886972160848707, 44.705632365558536], "
            "[-63.886986381242934, 44.705637746562346], [-63.887000600265068, "
            "44.705643037551191], [-63.887014694445384, 44.705648419531791], "
            "[-63.887028787253549, 44.705653711497469], [-63.887043007658157, "
            "44.705659092494116], [-63.887057101846203, 44.705664474469373], "
            "[-63.887071322256055, 44.705669855462475], [-63.887085416449331, 44.7056752374342], "
            "[-63.887099636864399, 44.705680618423671], [-63.887127825263903, "
            "44.705691382358275], [-63.887141909843137, 44.70569613423099], [-63.887156016423653, "
            "44.705702326312071], [-63.887170110632532, 44.705707708273216], "
            "[-63.887184206218961, 44.705713180245716], [-63.887198426652333, "
            "44.705718561222703], [-63.887212522244049, 44.705724033191665], "
            "[-63.887226744057706, 44.705729504178223], [-63.887240585841006, 44.70573488809174], "
            "[-63.887282872647681, 44.705751303977415], [-63.887296969630327, "
            "44.705756865948899], [-63.887310939021134, 44.705762338886203], "
            "[-63.887339004029918, 44.705773283774882], [-63.887353101023244, "
            "44.705778845739331], [-63.887367070424503, 44.705784318669664], "
            "[-63.887381167423136, 44.705789880630611], [-63.887409108989509, "
            "44.705801006508828], [-63.887423078401326, 44.705806479432198], "
            "[-63.887437175410604, 44.705812041386132], [-63.887451146203105, "
            "44.705817604319122], [-63.887465118373647, 44.705823257263511], "
            "[-63.887479215390989, 44.705828819212194], [-63.887493059971959, "
            "44.705834383120887], [-63.887498394203263, 44.705836502237595], "
            "[-63.887512366382921, 44.70584215517615], [-63.887526463409294, 44.705847717118857], "
            "[-63.887540309374778, 44.705853371034863], [-63.887554280186947, "
            "44.705858933955057], [-63.887610168964791, 44.70588154567097], [-63.887623888726729, "
            "44.705887200557726], [-63.887665805346522, 44.705904159321314], "
            "[-63.887679651338836, 44.705909813220188], [-63.887693498709609, "
            "44.705915557130439], [-63.887707344707316, 44.705921211025853], "
            "[-63.887721318303214, 44.705926953951518], [-63.887735165682152, "
            "44.705932697856653], [-63.887749137907683, 44.705938350765756], "
            "[-63.887762859072282, 44.705944095648647], [-63.88777683267913, 44.705949838567435], "
            "[-63.887832222254687, 44.705972814150286], [-63.887846071031404, 44.70597864805486], "
            "[-63.887873765841, 44.705990135832664], [-63.887901337193824, 44.706001804611205], "
            "[-63.887915184608175, 44.706007548494149], [-63.887929033401406, "
            "44.706013382388484], [-63.887942755977505, 44.706019217262515], [-63.88797032735782, "
            "44.706030886024102], [-63.887984049942141, 44.706036720893103], "
            "[-63.888011621338954, 44.706048389644572], [-63.888025345307817, "
            "44.706054314521623], [-63.888039194123124, 44.706060148402393], "
            "[-63.888052916721186, 44.706065983262974], [-63.888066640698355, 44.70607190813498], "
            "[-63.888080363301924, 44.706077742992207], [-63.888107811270153, "
            "44.706089592727835], [-63.8881216614785, 44.706095516611526], [-63.888176431239408, "
            "44.706119217037546], [-63.889063473164647, 44.706423526982974], "
            "[-63.890672155468188, 44.707250553674676], [-63.891168437958861, "
            "44.707557714135724], [-63.891461634776469, 44.707743305397059], "
            "[-63.892617034618617, 44.708404507290872], [-63.89315365025039, 44.708714404602411], "
            "[-63.894298951492836, 44.709250175219552], [-63.894542557292063, "
            "44.709354045184455], [-63.895358141309011, 44.709701807096017], "
            "[-63.896738487372801, 44.710078258539234], [-63.897013576565953, "
            "44.710152078130577], [-63.897352050659386, 44.710242863615854], "
            "[-63.898488392670245, 44.710374635916239], [-63.898520129077475, "
            "44.710377807119627], [-63.89855199032425, 44.710380887308155], [-63.898567795416248, "
            "44.71038247339871], [-63.898583726738096, 44.71038405849383], [-63.898599655274985, "
            "44.71038546356116], [-63.898615458976522, 44.710386959632274], [-63.898694978232882, "
            "44.710394165943306], [-63.898710905381932, 44.710395480982271], "
            "[-63.898726833924762, 44.710396886031781], [-63.898758563390444, "
            "44.710399607104819], [-63.898774615378166, 44.710400831128659], "
            "[-63.898790543923887, 44.710402236169266], [-63.898806343454808, "
            "44.710403462175584], [-63.898822395444512, 44.710404686192703], "
            "[-63.898854248360998, 44.710407226219992], [-63.898870172730241, 44.71040836121113], "
            "[-63.898886099886774, 44.710409676225602], [-63.898902150486343, 44.71041081021869], "
            "[-63.898917948628316, 44.710411946196771], [-63.898933999229058, 44.71041308018539], "
            "[-63.898949923601307, 44.7104142151654], [-63.898965972809755, 44.710415259136717], "
            "[-63.898981772347561, 44.710416485118706], [-63.898997821557131, "
            "44.710417529085539], [-63.899013743144636, 44.710418484031081], "
            "[-63.899029695391064, 44.710421419255354], [-63.899045589108262, "
            "44.710420573941036], [-63.899061638319964, 44.710421617898881], "
            "[-63.899077658265796, 44.710420771586321], [-63.899093609122268, 44.71042361678888], "
            "[-63.899109529319098, 44.710424481708252], [-63.899125452303814, "
            "44.710425526650951], [-63.899157545157983, 44.710427254490853], "
            "[-63.899173358640574, 44.710429380573913], [-63.899205431984356, "
            "44.710429848221587], [-63.899237524842952, 44.710431576038978], "
            "[-63.899253317420758, 44.710432351919493], [-63.899269361063247, "
            "44.710433035797024], [-63.899285407494034, 44.710433899697833], "
            "[-63.899301451137248, 44.710434583570887], [-63.899317369945713, "
            "44.710435358448485], [-63.899333414983701, 44.710436132329782], "
            "[-63.899349331004828, 44.710436727177381], [-63.899397461939706, "
            "44.710438778762729], [-63.899429421608048, 44.710440057456431], "
            "[-63.899445336236816, 44.710440562277874], [-63.899461378489171, "
            "44.710441156115657], [-63.8994934616005, 44.710442253771681], [-63.899509474573186, "
            "44.710440957334761], [-63.899525544712887, 44.710443351418675], "
            "[-63.899541457948821, 44.710443766213942], [-63.899557522512985, 44.71044580024234], "
            "[-63.899573539668324, 44.710444773834688], [-63.899589579133995, "
            "44.710445187628956], [-63.899605617205438, 44.71044551140816], [-63.899621658065961, "
            "44.710446015210643], [-63.899637696137717, 44.710446338985342], "
            "[-63.899653706318929, 44.710444862502712], [-63.899669899905334, 44.71044707554632], "
            "[-63.89968568551928, 44.710447401303185], [-63.899701724986251, 44.710447815081643], "
            "[-63.899781909771335, 44.710449073825409], [-63.899813983128183, "
            "44.710449541302033], [-63.89984605509057, 44.7104499187569], [-63.899861962750457, "
            "44.710449973456477], [-63.899877998034363, 44.710450117171909], "
            "[-63.899942136380375, 44.710450511985677], [-63.89995816887442, 44.710450475664388], "
            "[-63.899974202763431, 44.710450529353565], [-63.900022301640249, "
            "44.710450510382124], [-63.90005436662782, 44.710450437714741], [-63.900102461318305, "
            "44.710450148671278], [-63.900118491021288, 44.710449932301998], "
            "[-63.900134523514645, 44.710449895955925], [-63.900150553217372, 44.71044967958214], "
            "[-63.900165951774348, 44.710449468181046]]]"
        ]
        self.assertEqual(record, expected_record)


if __name__ == '__main__':
    unittest.main()
